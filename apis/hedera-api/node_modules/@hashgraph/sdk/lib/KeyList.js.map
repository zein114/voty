{"version":3,"file":"KeyList.js","sources":["../src/KeyList.js"],"sourcesContent":["// SPDX-License-Identifier: Apache-2.0\n\nimport Key from \"./Key.js\";\nimport CACHE from \"./Cache.js\";\n\n/**\n * @namespace proto\n * @typedef {import(\"@hashgraph/proto\").proto.IKey} HieroProto.proto.IKey\n * @typedef {import(\"@hashgraph/proto\").proto.IKeyList} HieroProto.proto.IKeyList\n * @typedef {import(\"@hashgraph/proto\").proto.IThresholdKey} HieroProto.proto.IThresholdKey\n */\n\n/**\n * A list of Keys (`Key`) with an optional threshold.\n */\nexport default class KeyList extends Key {\n    /**\n     * @param {?Key[]} [keys]\n     * @param {?number} [threshold]\n     */\n    constructor(keys, threshold) {\n        super();\n\n        /**\n         * @private\n         * @type {Key[]}\n         */\n        // @ts-ignore\n        if (keys == null) this._keys = [];\n        //checks if the value for `keys` is passed as a single key\n        //rather than a list that contains just one key\n        else if (keys instanceof Key) this._keys = [keys];\n        else this._keys = keys;\n\n        /**\n         * @type {?number}\n         */\n        this._threshold = threshold == null ? null : threshold;\n    }\n\n    /**\n     * @param {Key[]} keys\n     * @returns {KeyList}\n     */\n    static of(...keys) {\n        return new KeyList(keys, null);\n    }\n\n    /**\n     * @template T\n     * @param {ArrayLike<Key>} arrayLike\n     * @param {((key: Key) => Key)} [mapFn]\n     * @param {T} [thisArg]\n     * @returns {KeyList}\n     */\n    static from(arrayLike, mapFn, thisArg) {\n        if (mapFn == null) {\n            return new KeyList(Array.from(arrayLike));\n        }\n\n        return new KeyList(Array.from(arrayLike, mapFn, thisArg));\n    }\n\n    /**\n     * @returns {?number}\n     */\n    get threshold() {\n        return this._threshold;\n    }\n\n    /**\n     * @param {number} threshold\n     * @returns {this}\n     */\n    setThreshold(threshold) {\n        this._threshold = threshold;\n        return this;\n    }\n\n    /**\n     * @param {Key[]} keys\n     * @returns {number}\n     */\n    push(...keys) {\n        return this._keys.push(...keys);\n    }\n\n    /**\n     * @param {number} start\n     * @param {number} deleteCount\n     * @param {Key[]} items\n     * @returns {KeyList}\n     */\n    splice(start, deleteCount, ...items) {\n        return new KeyList(\n            this._keys.splice(start, deleteCount, ...items),\n            this.threshold,\n        );\n    }\n\n    /**\n     * @param {number=} start\n     * @param {number=} end\n     * @returns {KeyList}\n     */\n    slice(start, end) {\n        return new KeyList(this._keys.slice(start, end), this.threshold);\n    }\n\n    /**\n     * @returns {Iterator<Key>}\n     */\n    [Symbol.iterator]() {\n        return this._keys[Symbol.iterator]();\n    }\n\n    /**\n     * @returns {Key[]}\n     */\n    toArray() {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return this._keys.slice();\n    }\n\n    /**\n     * @returns {string}\n     */\n    toString() {\n        return JSON.stringify({\n            threshold: this._threshold,\n            keys: this._keys.toString(),\n        });\n    }\n\n    /**\n     * @returns {HieroProto.proto.IKey}\n     */\n    _toProtobufKey() {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-return\n        const keys = this._keys.map((key) => key._toProtobufKey());\n\n        if (this.threshold == null) {\n            return { keyList: { keys } };\n        } else {\n            return {\n                thresholdKey: {\n                    threshold: this.threshold,\n                    keys: { keys },\n                },\n            };\n        }\n    }\n\n    /**\n     * @param {HieroProto.proto.IKeyList} key\n     * @returns {KeyList}\n     */\n    static __fromProtobufKeyList(key) {\n        const keys = (key.keys != null ? key.keys : []).map((key) =>\n            Key._fromProtobufKey(key),\n        );\n        return new KeyList(keys);\n    }\n\n    /**\n     * @param {HieroProto.proto.IThresholdKey} key\n     * @returns {KeyList}\n     */\n    static __fromProtobufThresoldKey(key) {\n        const list = KeyList.__fromProtobufKeyList(\n            key.keys != null ? key.keys : {},\n        );\n        list.setThreshold(key.threshold != null ? key.threshold : 0);\n        return list;\n    }\n}\n\nCACHE.setKeyList((key) => KeyList.__fromProtobufKeyList(key));\nCACHE.setThresholdKey((key) => KeyList.__fromProtobufThresoldKey(key));\n"],"names":["KeyList","Key","constructor","keys","threshold","super","this","_keys","_threshold","of","from","arrayLike","mapFn","thisArg","Array","setThreshold","push","splice","start","deleteCount","items","slice","end","Symbol","iterator","toArray","toString","JSON","stringify","_toProtobufKey","map","key","keyList","thresholdKey","__fromProtobufKeyList","_fromProtobufKey","__fromProtobufThresoldKey","list","CACHE","setKeyList","setThresholdKey"],"mappings":"kDAee,MAAMA,UAAgBC,EAKjC,WAAAC,CAAYC,EAAMC,GACdC,QAOkBC,KAAKC,MAAX,MAARJ,EAA2B,GAGtBA,aAAgBF,EAAkB,CAACE,GAC1BA,EAKlBG,KAAKE,WAA0B,MAAbJ,EAAoB,KAAOA,CACrD,CAMI,SAAOK,IAAMN,GACT,OAAO,IAAIH,EAAQG,EAAM,KACjC,CASI,WAAOO,CAAKC,EAAWC,EAAOC,GAC1B,OACW,IAAIb,EADF,MAATY,EACmBE,MAAMJ,KAAKC,GAGfG,MAAMJ,KAAKC,EAAWC,EAAOC,GACxD,CAKI,aAAIT,GACA,OAAOE,KAAKE,UACpB,CAMI,YAAAO,CAAaX,GAET,OADAE,KAAKE,WAAaJ,EACXE,IACf,CAMI,IAAAU,IAAQb,GACJ,OAAOG,KAAKC,MAAMS,QAAQb,EAClC,CAQI,MAAAc,CAAOC,EAAOC,KAAgBC,GAC1B,OAAO,IAAIpB,EACPM,KAAKC,MAAMU,OAAOC,EAAOC,KAAgBC,GACzCd,KAAKF,UAEjB,CAOI,KAAAiB,CAAMH,EAAOI,GACT,OAAO,IAAItB,EAAQM,KAAKC,MAAMc,MAAMH,EAAOI,GAAMhB,KAAKF,UAC9D,CAKI,CAACmB,OAAOC,YACJ,OAAOlB,KAAKC,MAAMgB,OAAOC,WACjC,CAKI,OAAAC,GAEI,OAAOnB,KAAKC,MAAMc,OAC1B,CAKI,QAAAK,GACI,OAAOC,KAAKC,UAAU,CAClBxB,UAAWE,KAAKE,WAChBL,KAAMG,KAAKC,MAAMmB,YAE7B,CAKI,cAAAG,GAEI,MAAM1B,EAAOG,KAAKC,MAAMuB,IAAKC,GAAQA,EAAIF,kBAEzC,OAAsB,MAAlBvB,KAAKF,UACE,CAAE4B,QAAS,CAAE7B,SAEb,CACH8B,aAAc,CACV7B,UAAWE,KAAKF,UAChBD,KAAM,CAAEA,SAI5B,CAMI,4BAAO+B,CAAsBH,GACzB,MAAM5B,GAAoB,MAAZ4B,EAAI5B,KAAe4B,EAAI5B,KAAO,IAAI2B,IAAKC,GACjD9B,EAAIkC,iBAAiBJ,IAEzB,OAAO,IAAI/B,EAAQG,EAC3B,CAMI,gCAAOiC,CAA0BL,GAC7B,MAAMM,EAAOrC,EAAQkC,sBACL,MAAZH,EAAI5B,KAAe4B,EAAI5B,KAAO,CAAE,GAGpC,OADAkC,EAAKtB,aAA8B,MAAjBgB,EAAI3B,UAAoB2B,EAAI3B,UAAY,GACnDiC,CACf,EAGAC,EAAMC,WAAYR,GAAQ/B,EAAQkC,sBAAsBH,IACxDO,EAAME,gBAAiBT,GAAQ/B,EAAQoC,0BAA0BL"}