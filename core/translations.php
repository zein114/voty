<?php
header('Content-Type: application/javascript');
require_once __DIR__ . '/lang.php';

// Pass translations to JavaScript with English fallbacks
echo 'window.translations = ' .
    json_encode([
        // Auth translations
        'network_error' => t('network_error', 'Network error. Please try again.'),
        'enter_id' => t('enter_id', 'Please enter your NNI.'),
        'id_incorrect' => t('id_incorrect', 'The NNI is incorrect'),
        'user_registered' => t('user_registered', 'This user is already registered with a password'),
        'set_password' => t('set_password', 'Now set a password'),
        'password_required' => t('password_required', 'Password is required.'),
        'account_created' => t('account_created', 'Account created successfully!'),
        'something_wrong' => t('something_wrong', 'Something went wrong'),
        'password_wrong' => t('password_wrong', 'The password is incorrect.'),
        'login_successful' => t('login_successful', 'Login successful!'),
        'login_failed' => t('login_failed', 'Login failed'),
        'get_started' => t('get_started', 'Get Started'),
        'sign_in_subtitle' => t('sign_in_subtitle', 'Sign in to your account'),
        'sign_up_subtitle' => t('sign_up_subtitle', 'Create a new account'),
        'first_time' => t('first_time', 'First time?'),
        'sign_up' => t('sign_up', 'Sign Up'),
        'already_have_account' => t('already_have_account', 'Already have an account?'),
        'sign_in' => t('sign_in', 'Sign In'),
        'continue' => t('continue', 'Continue'),
        
        // Admin/Modal translations
        'add_admin' => t('add_admin', 'Add Administrator'),
        'edit_admin' => t('edit_admin', 'Edit Administrator'),
        'password' => t('password', 'Password'),
        'password_optional' => t('password_optional', 'Password (optional)'),
        'no_results_found' => t('no_results_found', 'No results found'),
        'try_different_search' => t('try_different_search', 'Try with different search terms'),
        'no_candidates_found' => t('no_candidates_found', 'No candidates found for this election.'),
        'position' => t('position', 'Position'),
        'party' => t('party', 'Party'),
        'remove' => t('remove', 'Remove'),
        'failed_to_load_candidates' => t('failed_to_load_candidates', 'Failed to load candidates'),
        'are_you_sure_remove_candidate' => t('are_you_sure_remove_candidate', 'Are you sure you want to remove this candidate?'),
        'candidate_removed_successfully' => t('candidate_removed_successfully', 'Candidate removed successfully'),
        'failed_to_remove_candidate' => t('failed_to_remove_candidate', 'Failed to remove candidate'),
        'error_removing_candidate' => t('error_removing_candidate', 'An error occurred while removing the candidate'),
        'select_a_position' => t('select_a_position', 'Select a position'),
        'create_position_first' => t('create_position_first', 'Please create a position for this election first.'),
        'candidate_added_successfully' => t('candidate_added_successfully', 'Candidate added successfully'),
        'failed_to_add_candidate' => t('failed_to_add_candidate', 'Failed to add candidate'),
        'error_adding_candidate' => t('error_adding_candidate', 'An error occurred while adding the candidate'),
        'select_position_for_candidate' => t('select_position_for_candidate', 'Please select a position for this candidate.'),
        'position_added_successfully' => t('position_added_successfully', 'Position added successfully'),
        'failed_to_add_position' => t('failed_to_add_position', 'Failed to add Position'),
        'error_adding_position' => t('error_adding_position', 'An error occurred while adding the position'),
        'failed_to_publish_results' => t('failed_to_publish_results', 'Failed to publish results'),
        'network_error_try_again' => t('network_error_try_again', 'Network error occurred. Please try again.'),
        'failed_to_unpublish_results' => t('failed_to_unpublish_results', 'Failed to unpublish results'),
        'enter_excel_file' => t('enter_excel_file', 'Please, Enter the Excel file'),
        'excel_format_invalid' => t('excel_format_invalid', 'Excel format is not valid'),
        'type_add_or_delete' => t('type_add_or_delete', 'Type "add" to create a position, or "delete" to remove one for this election:'),
        'arabic_name' => t('arabic_name', 'Arabic name:'),
        'english_name' => t('english_name', 'English name:'),
        'french_name' => t('french_name', 'French name:'),
        'cancelled' => t('cancelled', 'Cancelled'),
        'delete_position_confirm' => t('delete_position_confirm', 'Delete a position for this election? This will detach linked candidates.'),
        'position_delete_completed' => t('position_delete_completed', 'Position delete request completed'),
        'failed_to_delete_position' => t('failed_to_delete_position', 'Failed to delete position'),
        'error_deleting_position' => t('error_deleting_position', 'Error while deleting position'),
        'error_updating_election_type' => t('error_updating_election_type', 'An error occurred while updating election type'),
        'election_type_updated' => t('election_type_updated', 'Election type updated'),
        'failed_to_update_election_type' => t('failed_to_update_election_type', 'Failed to update election type'),
        'an_error_occurred' => t('an_error_occurred', 'An error occurred'),
        'modifier' => t('modifier', 'Edit'),
        'supprimer' => t('supprimer', 'Delete'),
        'add_super_admin' => t('add_super_admin', 'Add Super Administrator'),
        'edit_super_admin' => t('edit_super_admin', 'Edit Super Administrator'),
    ]) .
    ";\n";

echo "window.currentLang = '" . current_lang() . "';\n";
echo "window.t = function(key) { return window.translations[key] || key; };\n";
